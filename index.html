<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau Dashboard Embed</title>
    <style>
        .tableauPlaceholder {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        .tableauViz {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div class='tableauPlaceholder' id='viz1706533196244'></div>
    <script type='text/javascript'>
        function isTouchDevice() {
            return (('ontouchstart' in window) || (navigator.maxTouchPoints > 0) || (navigator.msMaxTouchPoints > 0));
        }

        function initTableauViz() {
            var placeholderDiv = document.getElementById('viz1706533196244');
            var url = 'https://public.tableau.com/views/29_01_17065331595530/2';

            if (isTouchDevice()) {
                url += '?:mobile=yes';
            }

            var vizElement = document.createElement('object');
            vizElement.className = 'tableauViz';
            vizElement.style.width = '100%';
            vizElement.style.height = '100%';
            vizElement.setAttribute('data', url);
            placeholderDiv.appendChild(vizElement);

            var params = [
                { name: 'host_url', value: 'https%3A%2F%2Fpublic.tableau.com%2F' },
                { name: 'embed_code_version', value: '3' },
                { name: 'site_root', value: '' },
                { name: 'name', value: '29_01_17065331595530/2' },
                { name: 'tabs', value: 'no' },
                { name: 'toolbar', value: 'yes' },
                { name: 'static_image', value: 'https://public.tableau.com/static/images/29/29_01_17065331595530/2/1.png' },
                { name: 'animate_transition', value: 'yes' },
                { name: 'display_static_image', value: 'yes' },
                { name: 'display_spinner', value: 'yes' },
                { name: 'display_overlay', value: 'yes' },
                { name: 'display_count', value: 'yes' },
                { name: 'language', value: 'en-US' },
                { name: 'filter', value: 'publish=yes' }
            ];

            params.forEach(function(param) {
                var paramElement = document.createElement('param');
                paramElement.name = param.name;
                paramElement.value = param.value;
                vizElement.appendChild(paramElement);
            });

            // Добавляем скрипт для Tableau API
            var scriptElement = document.createElement('script');
            scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
            document.body.appendChild(scriptElement);
        }

        window.onload = initTableauViz;
    </script>
</body>
</html>
