<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau Dashboard Embed</title>
    <style>
        .tableauPlaceholder {
            width: 100vw;
            height: 100vh;
            position: relative;
            overflow: hidden;
        }
        .tableauViz {
            width: 100%;
            height: 100%;
        }
        #undoButton {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 1000;
        }
    </style>
</head>
<body>
    <button id="undoButton">Отменить</button>
    <div class='tableauPlaceholder' id='viz1706533196244'></div>
    <script type='text/javascript'>
        var viz;

        function isTouchDevice() {
            return (('ontouchstart' in window) || (navigator.maxTouchPoints > 0) || (navigator.msMaxTouchPoints > 0));
        }

        function initTableauViz() {
            var placeholderDiv = document.getElementById('viz1706533196244');
            var url = 'https://public.tableau.com/views/29_01_17065331595530/2';

            if (isTouchDevice()) {
                url += '?:mobile=yes';
            }

            var vizElement = document.createElement('object');
            vizElement.className = 'tableauViz';
            vizElement.style.width = '100%';
            vizElement.style.height = '100%';
            vizElement.setAttribute('data', url);
            placeholderDiv.appendChild(vizElement);

            var params = [
                // ... Ваши параметры ...
            ];

            params.forEach(function(param) {
                var paramElement = document.createElement('param');
                paramElement.name = param.name;
                paramElement.value = param.value;
                vizElement.appendChild(paramElement);
            });

            // Добавляем скрипт для Tableau API
            var scriptElement = document.createElement('script');
            scriptElement.onload = function() {
                var options = {
                    hideTabs: true,
                    onFirstInteractive: function () {
                        document.getElementById("undoButton").onclick = function() {
                            viz.revertAllAsync();
                        };
                    }
                };
                viz = new tableau.Viz(placeholderDiv, url, options);
            }
            scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
            document.body.appendChild(scriptElement);
        }

        window.onload = initTableauViz;
    </script>
</body>
</html>
